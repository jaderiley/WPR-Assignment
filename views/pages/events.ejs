<%- include('../partials/header') %>

<h1>Upcoming Events</h1>

<div class="game-container events-container">
  <div class="game-header">
    <span class="game-title">EVENT SEARCH</span>
  </div>
  <div class="game-content">
    <div class="search-controls">
      <div class="search-box">
        <input type="text" id="eventSearch" placeholder="Search events..." class="game-input">
      </div>
      <div class="filter-toggle">
        <label class="switch-label">Name</label>
        <label class="game-switch">
          <input type="checkbox" id="toggleLocation">
          <span class="switch-slider"></span>
        </label>
        <label class="switch-label">Location</label>
      </div>
    </div>
    <div class="event-grid" id="eventGrid">
      <% events.forEach(event => { %>
        <a href="/event/<%= event.title.toLowerCase().replace(/[^a-zA-Z0-9]/g, '-') %>" class="event-card"
           data-name="<%= event.title.toLowerCase() %>"
           data-location="<%= event.location.toLowerCase() %>"
           style="background-image: url('<%= event.image %>');
                  background-size: cover;
                  background-position: center;
                  background-repeat: no-repeat;
                  display: block;
                  text-decoration: none;">
          <div class="content">
            <h3 class="event-title"><%= event.title %></h3>
            <p class="event-date"><%= event.date %></p>
            <p class="event-location"><%= event.location %></p>
            <p class="event-description"><%= event.description %></p>
          </div>
        </a>
      <% }); %>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const searchInput = document.getElementById('eventSearch');
  const eventGrid = document.getElementById('eventGrid');
  const toggleSwitch = document.getElementById('toggleLocation');
  let searchByLocation = false;

  function filterEvents() {
    const searchTerm = searchInput.value.toLowerCase();
    const eventCards = eventGrid.getElementsByClassName('event-card');

    Array.from(eventCards).forEach(card => {
      const searchAttribute = searchByLocation ? 'data-location' : 'data-name';
      const cardValue = card.getAttribute(searchAttribute);
      const isVisible = cardValue.includes(searchTerm);
      card.style.display = isVisible ? 'block' : 'none';
    });
  }

  searchInput.addEventListener('input', filterEvents);

  toggleSwitch.addEventListener('change', function() {
    searchByLocation = this.checked;
    searchInput.placeholder = searchByLocation ? 'Search by location...' : 'Search events...';
    filterEvents();
  });
});
</script>

<%- include('../partials/footer') %>